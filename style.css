/* ========= 1) 変数（デフォルト） ========= */
:root{
  --bg: #0f1115;
  --card: #161922;
  --ink: #e7e9ee;
  --muted: #aab0c0;
  --accent: #7c9cff;
  --ok:#38d39f; --warn:#ffce5c;
  --space:16px;
}

/* ========= 2) テーマ（WAVE / NATURAL / STRAIGHT） ========= */
body[data-theme="WAVE"]{
  --bg:#FFF7FA; --card:#FFFFFF; --ink:#5A2A41; --muted:#8C6677; --accent:#F7C6D9;
}
body[data-theme="NATURAL"]{
  --bg:#F8FBF7; --card:#FFFFFF; --ink:#324A35; --muted:#6A7C6F; --accent:#B6D7A8;
}
body[data-theme="STRAIGHT"]{
  --bg:#F7FAFD; --card:#FFFFFF; --ink:#1F3347; --muted:#5F6F81; --accent:#A4C6EB;
}

/* ========= 3) ベース / レイアウト ========= */
*{ box-sizing:border-box }
html,body{
  height:100%; min-height:100vh; margin:0;
  background: var(--bg); color: var(--ink);
  -webkit-text-size-adjust:100%;
}
body{ -webkit-tap-highlight-color:transparent; touch-action:manipulation; line-height:1.6;
       font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; }
.wrap{ max-width:980px; margin:0 auto; padding:20px var(--space); background:transparent; }
header{ display:flex; align-items:center; gap:12px; margin-bottom:16px }
header .badge{ padding:4px 10px; border-radius:999px; font-size:12px; background:color-mix(in oklab,var(--accent) 18%,transparent); color:color-mix(in oklab,var(--ink) 85%,black); border:1px solid color-mix(in oklab,var(--accent) 28%,transparent) }
h1{ margin:0; font-size:20px }

.card{
  background: var(--card); color: var(--ink);
  border:1px solid color-mix(in oklab, var(--ink) 10%, transparent);
  border-radius:16px;
  box-shadow:0 8px 30px rgba(17 24 39 / .10), 0 2px 10px rgba(17 24 39 / .06);
  padding:16px;
}

.controls{ display:flex; gap:12px; flex-wrap:wrap; margin-top:12px }
button{
  appearance:none; border:none; border-radius:12px;
  padding:12px 16px; font-weight:700; cursor:pointer;
  background: var(--accent); color:#0b0e15;
}
button.secondary{
  background: color-mix(in oklab, var(--accent) 18%, transparent);
  border:1px solid color-mix(in oklab, var(--accent) 28%, transparent);
  color: color-mix(in oklab, var(--ink) 90%, black);
}
button:hover{ filter:brightness(1.05) }

.grid{ display:grid; gap:14px }
.cols{ display:grid; grid-template-columns:1fr; gap:16px }
@media(min-width:860px){ .cols{ grid-template-columns:1.2fr .8fr } }
.footer{ display:flex; justify-content:space-between; align-items:center; margin-top:16px }
@media(max-width:760px){
  .controls{ flex-direction:column }
  button,.controls button{ width:100%; padding:14px 16px; font-size:16px }
  .footer{ position:sticky; bottom:0; z-index:20;
           background:linear-gradient(180deg, rgba(0,0,0,0), var(--card)); padding-top:10px; margin-top:18px; }
}

/* ========= 4) コンポーネント ========= */
.q{
  padding:12px; border-radius:12px;
  background: var(--card);
  border:1px solid color-mix(in oklab, var(--ink) 12%, transparent);
}
.q h4{ margin:0 0 8px 0; font-size:14px; line-height:1.5;
       color: color-mix(in oklab, var(--ink) 95%, black); }
.muted,.small,.scale label{ color: var(--muted) }

.scale{ display:flex; gap:8px; align-items:center }
.scale input{ width:100%; accent-color: var(--accent); height:30px }
input[type=range]::-webkit-slider-thumb{ -webkit-appearance:none; width:26px; height:26px; border-radius:50%; background:#fff; border:2px solid color-mix(in oklab, var(--ink) 45%, black); box-shadow:0 2px 6px rgba(0,0,0,.15) }
input[type=range]::-moz-range-thumb{ width:26px; height:26px; border-radius:50%; background:#fff; border:2px solid color-mix(in oklab, var(--ink) 45%, black); box-shadow:0 2px 6px rgba(0,0,0,.15) }

.progress{ height:8px; background:color-mix(in oklab, var(--ink) 10%, transparent);
           border:1px solid color-mix(in oklab, var(--ink) 14%, transparent); border-radius:999px; overflow:hidden }
.bar{ height:100%; width:0; background:linear-gradient(90deg, var(--accent), color-mix(in oklab, var(--accent) 60%, white)) }

.traits{ display:grid; gap:14px; margin-top:12px }
.trait{ background: var(--card); border:1px solid color-mix(in oklab, var(--ink) 12%, transparent);
        border-radius:12px; padding:12px }
.trait .row{ display:flex; justify-content:space-between; align-items:center; margin-bottom:6px }
.trait .title{ font-weight:700; color: color-mix(in oklab, var(--ink) 95%, black) }
.trait .percent{ font-weight:700 }
.meter{ position:relative; height:14px; border-radius:999px; overflow:hidden;
        background:color-mix(in oklab, var(--ink) 10%, transparent);
        border:1px solid color-mix(in oklab, var(--ink) 14%, transparent) }
.meter .fill{ position:absolute; inset:0 auto 0 0; height:100%;
              background:linear-gradient(90deg, var(--accent), color-mix(in oklab, var(--accent) 60%, white)) }
.meter .thumb{ position:absolute; top:50%; transform:translate(-50%,-50%); width:22px; height:22px; border-radius:50%;
               background:#fff; border:2px solid color-mix(in oklab, var(--ink) 45%, black); box-shadow:0 2px 6px rgba(0,0,0,.4) }
.trait .ends{ display:flex; justify-content:space-between; font-size:12px; color:var(--muted); margin-top:6px }

.hero{ width:100%; aspect-ratio:4/3; object-fit:cover; border-radius:12px;
       background: var(--bg); border:1px solid color-mix(in oklab, var(--ink) 12%, transparent);
       box-shadow:0 10px 30px rgba(0,0,0,.25) }
.tags,.chips{ display:flex; gap:6px; flex-wrap:wrap; margin:8px 0 }
.tag,.chip{
  padding:6px 10px; font-size:11px; border-radius:999px;
  background: color-mix(in oklab, var(--accent) 18%, transparent);
  border:1px solid color-mix(in oklab, var(--accent) 28%, transparent);
  color: color-mix(in oklab, var(--ink) 85%, black);
}

.ok{ color: var(--ok) } .warn{ color: var(--warn) }
table{ width:100%; border-collapse:collapse }
th,td{ border-bottom:1px solid color-mix(in oklab, var(--ink) 12%, transparent); padding:8px 6px; text-align:left }

/* ダッシュボード埋め込み */
.dash{ margin-top:40px }
.dash-card{ composes: card; } /* ツールが無ければ普通に .card を使うだけでOK */
.dash-frame{ margin-top:12px; border-radius:12px; overflow:hidden; background:var(--bg);
             border:1px solid color-mix(in oklab, var(--ink) 12%, transparent) }
.dash-embed{ width:100%; aspect-ratio:16/9; display:block; border:0 }